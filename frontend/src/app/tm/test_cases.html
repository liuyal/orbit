<app-navbar [showBackButton]="true" [backButtonText]="'Back to Projects'" [backButtonAction]="goBack.bind(this)"></app-navbar>

<div class="content">
<div class="tabs-container">
  <div class="tabs">
    <button class="tab" [class.active]="activeTab === 'test-cases'" (click)="activeTab = 'test-cases'">
      <i class="fa-solid fa-flask"></i>
      Test Cases
    </button>
    <button class="tab" [class.active]="activeTab === 'test-cycles'" (click)="activeTab = 'test-cycles'">
      <i class="fa-regular fa-rectangle-list"></i>
      Test Cycles
      </button>
      <button class="create-btn-tab" (click)="createTestCase()">
        <i class="fa-solid fa-plus"></i>
      </button>
    </div>
  </div>

  <div class="tab-content">
    @if (activeTab === 'test-cases') {
    <div>
      @if (loading) {
      } @else if (error) {
      <p style="color: #f44336;">{{ error }}</p>
      } @else if (testCases.length === 0) {
      <p style="color: #999;">No test cases found for this project.</p>
      } @else {
      <div class="test-cases-list">
        <table>
          <thead>
            <tr>
              <th>Key</th>
              <th>Title</th>
              <th>Status</th>
              <th>Priority</th>
              <th>Result</th>
              <th></th>
            </tr>
          </thead>
          <tbody>
            @for (testCase of testCases; track testCase._id) {
            <tr (click)="editTestCase(testCase)">
              <td>{{ testCase.test_case_key }}</td>
              <td>{{ testCase.title || 'Untitled' }}</td>
              <td>
                <span class="status-badge" [attr.data-status]="testCase.status">
                  {{ testCase.status || 'N/A' }}
                </span>
              </td>
              <td>
                <span class="priority-badge" [attr.data-priority]="testCase.priority">
                  {{ testCase.priority || 'N/A' }}
                </span>
              </td>
              <td>
                <span class="result-badge" 
                      [attr.data-result]="testCase.last_result || 'NOT_EXECUTED'"
                      [attr.title]="testCase.last_result || 'Not Executed'">
                  {{ (testCase.last_result || 'NOT_EXECUTED').charAt(0) }}
                </span>
              </td>
              <td>
                <div class="action-buttons">
                  <button class="action-btn edit" (click)="$event.stopPropagation(); editTestCase(testCase)">
                    <i class="fa-solid fa-pen-to-square"></i>
                  </button>
                  <button class="action-btn delete" (click)="$event.stopPropagation(); deleteTestCase(testCase)">
                    <i class="fa-solid fa-trash"></i>
                  </button>
                </div>
              </td>
            </tr>
            }
          </tbody>
        </table>
      </div>
      }
    </div>
    } @else if (activeTab === 'test-cycles') {
    <div>
      <p style="color: #999;">Test cycles functionality coming soon...</p>
    </div>
    }
  </div>
</div>