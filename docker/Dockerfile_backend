# Dockerfile for Python backend with minimal Alpine base
FROM python:3.12-alpine

# Maintainer information
LABEL maintainer="jerry"
WORKDIR /home

# Install only essential packages
RUN apk add --no-cache \
        supervisor

# Backend code will be mounted as a volume
ENV PYTHONPATH=/home/orbit
ENV MONGODB_HOST=db-app

# Copy requirements file and install dependencies
# Note: requirements.txt should be copied or the entire backend mounted
COPY requirements.txt /tmp/requirements.txt
RUN pip install --no-cache-dir -r /tmp/requirements.txt

# Configure Supervisor to manage container services
COPY supervisord.conf /etc/supervisor/conf.d/supervisord.conf
CMD ["/usr/bin/supervisord", "-c", "/etc/supervisor/conf.d/supervisord.conf"]
